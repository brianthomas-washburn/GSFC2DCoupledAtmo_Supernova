
	SUBROUTINE NOPHOT(ENOP,IJC,IKC,ICLOCK)

        include "com2d.h"
        include "comphot.h"

	COMMON/CHIDSFAC/CHIDA(18,L$),SFACA(18,L$)
        COMMON/NOPARAM/SMO2A(6),SMWA(6,2),SMNOA(6,2),SMO2B(6),
     *  SMWB(6,2),SMNOB(6,2),SMO2C(6),SMWC(6,2),SMNOC(6,2)
	DIMENSION TMNOA(6),TMNOB(6),TMNOC(6)

        SAVE


C   store ozone x-section for the current  grid point as fxn of temperature 
C           XO3(IL$), XSECTTD(PH$,IL$,201)  are in COMMON:
C
        iit = IDINT(temp(ijc,ikc) + 0.5) - 119
        IF (temp(ijc,ikc) .LT. 120.) iit = 1
        IF (temp(ijc,ikc) .GT. 320.) iit = 201

        DO 702 I = 1,IL$
 702	   XO3(I) = xsecttd(2,I,iit) + xsecttd(3,I,iit)


        ENOP=0.0E0

	DO 400 JL=1,3
	ENOP=ENOP + XSECT(16,JL)*RFLUX(JL,IJC,IKC)
400	CONTINUE

	SPDIS=1.65E9
C SPDIS is the rate of spontaneous dissociation
	EMISSION=5.1E7
C EMISSION is the emission from the C(2PIv=0) state
	RKQ=1.5E-9
C RKQ is the quenching rate constant from N2
	DENN2=N2(IJC,IKC)
C DENN2 is the number density of N2
	PDIS=SPDIS/(EMISSION + SPDIS + (RKQ*DENN2))

C  use DIURNALLY varying O3, NO columns in NCOLD(2,18+3,L$,Z$) in COMMON ; 1=Ozone;  2=NO

	TO3COL = NCOLD(1,iclock,IJC,IKC)*SFACA(ICLOCK,IJC)    ! NCOLGD(2,IJC,IKC)*SFACA(ICLOCK,IJC)
  	 COLNO = NCOLD(2,iclock,IJC,IKC)*SFACA(ICLOCK,IJC)    ! NCOLGD(3,IJC,IKC)*SFACA(ICLOCK,IJC)
         COLO2 = NCOLGD(1,IJC,IKC)*SFACA(ICLOCK,IJC)

c	IF(IDAY360.EQ.80 .AND. IJC.EQ.9 .AND. IKC.EQ.46)THEN
c	   WRITE(6,7010)ENOP,TO3COL,COLNO,PDIS,DENN2
c 7010	   FORMAT(' JNO=',1PE12.4,' TO3COL=',1PE12.4,' COLNO=',
c     *  1PE12.4,' PDIS=',1PE12.4,' DENN2=',1PE12.4)
c	   ENDIF

	TERMA=0.0E0
	DO 1000 I=1,6
	TMNOA(I)=EXP(-SMO2A(I)*COLO2) *
     *  (SMWA(I,1)*SMNOA(I,1)*EXP(-SMNOA(I,1)*COLNO) +
     *  SMWA(I,2)*SMNOA(I,2)*EXP(-SMNOA(I,2)*COLNO))
	TERMA=TERMA+TMNOA(I)
c	IF(IDAY360.EQ.80 .AND. IJC.EQ.9 .AND. IKC.EQ.46)THEN
c	   WRITE(6,9003)TMNOA(I),SMO2A(I),NCOLGD(1,IJC,IKC),
c     *  SMWA(I,1),SMNOA(I,1),SMWA(I,2),SMNOA(I,2),TERMA,I
c 9003	   FORMAT(' TMNOA=',1PE12.4,' SMO2A=',1PE12.4,' NCOLGD=',
c     *  1PE12.4,' SMWA=',1PE12.4,' SMNOA=',1PE12.4,' SMWA=',
c     *  1PE12.4,' SMNOA=',1PE12.4,' TERMA=',1PE12.4,' I=',I3)
c	   ENDIF
 1000	CONTINUE

	TERMB=0.0E0
	DO 2000 I=1,6
	TMNOB(I)=EXP(-SMO2B(I)*COLO2) *
     *  (SMWB(I,1)*SMNOB(I,1)*EXP(-SMNOB(I,1)*COLNO) +
     *  SMWB(I,2)*SMNOB(I,2)*EXP(-SMNOB(I,2)*COLNO))
	TERMB=TERMB+TMNOB(I)
c	IF(IDAY360.EQ.80 .AND. IJC.EQ.9 .AND. IKC.EQ.46)THEN
c	   WRITE(6,9002)TMNOB(I),SMO2B(I),NCOLGD(1,IJC,IKC),
c     *  SMWB(I,1),SMNOB(I,1),SMWB(I,2),SMNOB(I,2),TERMB,I
c 9002	   FORMAT(' TMNOB=',1PE12.4,' ,SMO2B=',1PE12.4,' NCOLGD=',
c     *  1PE12.4,' SMWB=',1PE12.4,' SMNOB=',1PE12.4,' SMWB=',
c     *  1PE12.4,' SMNOB=',1PE12.4,' TERMB=',1PE12.4,' I=',I3)
c	   ENDIF
 2000	CONTINUE

	TERMC=0.0E0
	DO 3000 I=1,6
	TMNOC(I)=EXP(-SMO2C(I)*COLO2) *
     *  (SMWC(I,1)*SMNOC(I,1)*EXP(-SMNOC(I,1)*COLNO) +
     *  SMWC(I,2)*SMNOC(I,2)*EXP(-SMNOC(I,2)*COLNO))
	TERMC=TERMC+TMNOC(I)
c	IF(IDAY360.EQ.80 .AND. IJC.EQ.9 .AND. IKC.EQ.46)THEN
c	   WRITE(6,9001)TMNOC(I),SMO2C(I),NCOLGD(1,IJC,IKC),
c     *  SMWC(I,1),SMNOC(I,1),SMWC(I,2),SMNOC(I,2),TERMC,I
c 9001	   FORMAT(' TMNOC=',1PE12.4,' ,SMO2C=',1PE12.4,' NCOLGD=',
c     *  1PE12.4,' SMWC=',1PE12.4,' SMNOC=',1PE12.4,' SMWC=',
c     *  1PE12.4,' SMNOC=',1PE12.4,' TERMC=',1PE12.4,' I=',I3)
c	   ENDIF
 3000	CONTINUE

	DO 410 JL=8,9
	FRNO=PDIS * EXP(-XO3(JL)*TO3COL)
	IF(JL.EQ.8)FRACWI=(181.8-181.6)/(181.8-180.2)
	IF(JL.EQ.9)FRACWI=(183.1-181.8)/(183.5-181.8)
	ENOP=ENOP + 
     *  FRACWI * RFLUX(JL,IJC,Z$) * FRNO * TERMC
c	IF(IDAY360.EQ.80 .AND. IJC.EQ.9 .AND. IKC.EQ.46)THEN
c	   WRITE(6,7001)ENOP,FRACWI,RFLUX(JL,IJC,Z$),
c     *  FRNO,TERMC,JL
c 7001	   FORMAT(' JNO=',1PE12.4,' FRACWI=',1PE12.4,' F=',
c     *  1PE12.4,' FRNO=',1PE12.4,' TERMC=',1PE12.4,' JL=',I3)
c	   ENDIF
410	CONTINUE

	DO 420 JL=9,10
	FRNO=PDIS * EXP(-XO3(JL)*TO3COL)
	IF(JL.EQ.9)FRACWI=(183.5-183.1)/(183.5-181.8)
	IF(JL.EQ.10)FRACWI=(184.6-183.5)/(185.2-183.5)
	ENOP=ENOP + 
     *  FRACWI * RFLUX(JL,IJC,Z$) * FRNO * TERMB
c	IF(IDAY360.EQ.80 .AND. IJC.EQ.9 .AND. IKC.EQ.46)THEN
c	   WRITE(6,7002)ENOP,FRACWI,RFLUX(JL,IJC,Z$),
c     *  FRNO,TERMB,JL
c 7002	   FORMAT(' JNO=',1PE12.4,' FRACWI=',1PE12.4,' F=',
c     *  1PE12.4,' FRNO=',1PE12.4,' TERMB=',1PE12.4,' JL=',I3)
c	   ENDIF
420	CONTINUE

	DO 430 JL=13,15
	FRNO=PDIS * EXP(-XO3(JL)*TO3COL)
	IF(JL.EQ.13)FRACWI=(190.5-190.2)/(190.5-188.7)
	IF(JL.EQ.14)FRACWI=1.0E0
	IF(JL.EQ.15)FRACWI=(192.5-192.3)/(194.2-192.3)
	ENOP=ENOP + 
     *  FRACWI * RFLUX(JL,IJC,Z$) * FRNO * TERMA
c	IF(IDAY360.EQ.80 .AND. IJC.EQ.9 .AND. IKC.EQ.46)THEN
c	   WRITE(6,7003)ENOP,FRACWI,RFLUX(JL,IJC,Z$),
c     *  FRNO,TERMA,JL
c 7003	   FORMAT(' JNO=',1PE12.4,' FRACWI=',1PE12.4,' F=',
c     *  1PE12.4,' FRNO=',1PE12.4,' TERMA=',1PE12.4,' JL=',I3)
c	   ENDIF
430	CONTINUE

	RETURN
	END


